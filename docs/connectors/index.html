<!DOCTYPE html><html lang="en-gb"><head><meta name="generator" content="Hugo 0.20.7"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Syndesis connectors development | Syndesis</title><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-98663114-1","auto"),ga("send","pageview")</script><link rel="canonical" href="https://syndesis.io/docs/connectors/"><link rel="icon" type="image/png" href="https://syndesis.io/images/favicon.png"><meta name="generator" content="Hugo 0.20.7"><link href="https://fonts.googleapis.com/css?family=Raleway:400,500|Righteous" rel="stylesheet"><link rel="stylesheet" href="https://syndesis.io/css/syndesis.css"></head><body class="docs"><div id="wrapper"><a href="https://github.com/syndesisio" class="github-corner hidden-md-down" aria-label="View source on Github" rel="nofollow" target="_blank"><svg width="74" height="74" viewBox="0 0 250 250" style="fill:#fff;z-index:2000;color:#0088ce;mix-blend-mode:screen;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7
        120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9
        125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6
        C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0
        C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1
        C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4
        C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9
        C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5
        C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9
        L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><nav class="navbar fixed-top navbar-inverse bg-primary navbar-toggleable-md sps sps--abv"><button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-nav" aria-controls="top-nav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button> <a href="https://syndesis.io/" title="Syndesis"><svg id="artwork" xmlns="http://www.w3.org/2000/svg" width="190px" height="39.33px" viewBox="0 0 1300 300" preserveAspectRatio="xMidYMin slice"><defs><style>.cls-1{fill:#9adde8}.cls-2{fill:#49badc}.cls-3{fill:#fff}</style></defs><title>Syndesis Logo</title><polygon class="cls-1" points="129.95 98.77 33.99 144.38 122.22 167.37 218.18 121.75 129.95 98.77"/><polygon class="cls-2" points="218.18 121.75 218.18 121.75 122.22 167.37 242.17 198.61 218.18 121.75"/><polygon class="cls-1" points="154.99 86.86 131 10 10 67.52 129.95 98.77 154.99 86.86"/><polygon class="cls-2" points="33.99 144.38 129.95 98.77 10 67.52 10 67.52 33.99 144.38"/><polygon class="cls-2" points="189.64 25.27 131 10 154.99 86.86 213.63 102.14 189.64 25.27"/><polygon class="cls-2" points="38.54 164 62.53 240.86 121.17 256.13 121.17 256.13 97.18 179.27 97.18 179.27 38.54 164"/><polygon class="cls-1" points="242.17 198.61 122.22 167.37 97.18 179.27 121.17 256.13 242.17 198.61"/><path class="cls-3" d="M358.91,210.23c-23.57,0-43.44-17.22-44.06-41.6H329.2c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.65-9.63,35.65-28.48,0-14.76-10.65-21.73-23.15-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.15,35.25H399.28c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C416.29,200.39,388.62,210.23,358.91,210.23Z"/><path class="cls-3" d="M484.32,143.22l-54.51-84h17l45.29,71.52L537.4,59.2h14.34l-54.1,83.61v64.34H484.32Z"/><path class="cls-3" d="M572.24,59.2H587.4L669,189.32h.41V59.2h13.32v148h-16.8L586,79.28h-.41V207.15H572.24Z"/><path class="cls-3" d="M760,59.2c48.56,0,76.23,25,76.23,74s-27.67,74-76.23,74H720V59.2Zm3.27,135.66c41.6,0,58.61-24.39,58.61-61.69,0-43.64-25.61-62.91-67.62-61.68h-20.9V194.86Z"/><path class="cls-3" d="M870.19,207.15V59.2H958.1V71.49H883.51v53.08h71.73v12.29H883.51v58h77.67v12.29Z"/><path class="cls-3" d="M1030.44,210.23c-23.56,0-43.44-17.22-44.05-41.6h14.34c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.66-9.63,35.66-28.48,0-14.76-10.66-21.73-23.16-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.16,35.25h-14.35c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C1087.82,200.39,1060.16,210.23,1030.44,210.23Z"/><path class="cls-3" d="M1121.63,207.15V58.58H1135V207.15Z"/><path class="cls-3" d="M1212.62,210.23c-23.56,0-43.44-17.22-44.06-41.6h14.35c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.66-9.63,35.66-28.48,0-14.76-10.66-21.73-23.16-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.16,35.25H1253c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C1270,200.39,1242.34,210.23,1212.62,210.23Z"/></svg></a><div class="collapse navbar-collapse" id="top-nav"><ul class="navbar-nav ml-auto mt-2 mt-md-0 mr-lg-4"><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/quickstart/">quickstart</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/docs/">docs</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/blog/">blog</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/faq/">faq</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/community/">community</a></li></ul></div></nav><div id="main" class="d-flex flex-row"><div id="sidebar" class="sidenav"><aside><ul class="sidebar-menu"><li class="nav-button hidden-lg-up"><button type="button" class="btn btn-primary btn-sm" data-toggle="offcanvas" data-target="#sidebar">Hide nav</button></li><li><a class="" href="https://syndesis.io/about/"><i class="fa fa-fw fa-download"></i> <span>About Syndesis</span></a></li><li><a class="" href="https://syndesis.io/quickstart/"><i class="fa fa-fw fa-rocket"></i> <span>Quickstart</span></a></li><li class="sub-menu active"><a class="d-flex justify-content-between" href="https://syndesis.io/docs/"><span><i class="fa fa-fw fa-book"></i> Developer Docs</span> <span class="mr-1 expander"></span></a><ul class="sub collapse show"><li><a href="https://syndesis.io/docs/development/">Development</a></li><li><a href="https://syndesis.io/docs/backend_architecture/">Backend architecture</a></li><li><a href="https://syndesis.io/docs/cli/">CLI</a></li><li class="active"><a href="https://syndesis.io/docs/connectors/">Connectors development</a></li></ul></li><li><a class="" href="https://syndesis.io/faq/"><i class="fa fa-fw fa-file-text"></i> <span>FAQ</span></a></li><li class="sub-menu"><a class="d-flex justify-content-between" href="https://syndesis.io/community/"><span><i class="fa fa-fw fa-group"></i> Community</span> <span class="mr-1 expander"></span></a><ul class="sub collapse"><li><a href="https://syndesis.io/community/contributing/">Contributing</a></li><li><a href="https://syndesis.io/community/engineering_guidelines/">Engineering Guidelines</a></li></ul></li><li><a href="https://github.com/syndesisio/syndesis/issues/" target="blank"><i class="fa fa-life-ring"></i> <span>Issues & Help</span></a></li><li><a href="https://github.com/syndesisio/syndesis.io/edit/master/content/docs/connectors.md" target="blank"><i class="fa fa-fw fa-edit"></i> Refine this Page</a></li></ul></aside></div><div class="main-content"><div itemscope class="doc"><meta itemprop="name" content="Syndesis connectors development"><meta itemprop="description" content="One of the most important features of Syndesis is to be able to connect to a variety of sources and destinations. This middleware product will transparently take care of the integration of such data source/destination. It just requires a custom development of the specific transport involved in the chosen component.
Since Apache Camel is providing a large offering of integrations components, Syndesis does offer the possibility to use them thanks to a proxy component whose goal is to identify the component and provide the correct configuration settings to make them available through the user interface."><meta itemprop="wordCount" content="4498"><meta itemprop="keywords" content=""><div class="hero"><h1 itemprop="headline">Syndesis connectors development</h1></div><div itemprop="docBody" class="docBody"><p>One of the most important features of Syndesis is to be able to connect to a variety of sources and destinations. This middleware product will transparently take care of the integration of such data source/destination. It just requires a custom development of the specific transport involved in the chosen component.</p><p>Since Apache Camel is providing a large <a href="https://camel.apache.org/components.html">offering of integrations components</a>, Syndesis does offer the possibility to use them thanks to a proxy component whose goal is to identify the component and provide the correct configuration settings to make them available through the user interface.</p><h3 id="tutorial">Tutorial</h3><p>We will use as a reference the development of a connector for MongoDB and we will try to show explicitly all the configuration and development you will have to perform in order to develop your own connector.</p><p>If you haven’t done it yet, fork the syndesis project, check it out locally and familiarize with its structure. Also you may want to read the <a href="https://syndesis.io/community/contributing/#1-fork-the-repository">engineering guidelines</a> before starting to work on it.</p><h3 id="camel-upstream-component">Camel upstream component</h3><p>The first thing you will have to do is to have a look at the list of camel components provided in the introduction. Fortunately there is quite a lot of components available, so you should be lucky as in the example I’m going to show for <a href="https://camel.apache.org/mongodb.html">MongoDB</a>.</p><p>If by any chance you are out of luck and the component is not available, well, it is a good opportunity to contribute by <a href="http://oscerd.github.io/2016/07/06/contributing-camel-components/">developing the component yourself</a>.</p><p>First thing to do is to familiarize with the URI structure that the component is going to use in camel. For the MongoDB example this is a typical example:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>mongodb<span style="color:#000;font-weight:700">:</span>connectionBean<span style="color:#000;font-weight:700">?</span>database<span style="color:#000;font-weight:700">=</span>databaseName<span style="color:#000;font-weight:700">&amp;</span>collection<span style="color:#000;font-weight:700">=</span>collectionName<span style="color:#000;font-weight:700">&amp;</span>operation<span style="color:#000;font-weight:700">=</span>operationName<span style="color:#000;font-weight:700">[&amp;</span>moreOptions<span style="color:#000;font-weight:700">...]</span>
</pre></div><p>The most important thing you have to check is the protocol. In this example is “mongodb”, so, make sure to take note of that one as it will be the way to configure and identify the component on the Camel catalog from now onward. Also it is quite important for you to identify which are the parameters used, in particular the mandatory ones and which are needed for producer or for consumer purpose and their type: typically they are text representing a configuration, but in some circumstances they may represent more complex java objects such as a Datasource or a connection bean of some sort.</p><p>I would even suggest to make some experiment and test directly on the upstream component in order to familiarize with the component itself. Finally, your goal is to integrate on Syndesis, but this will end up in a Camel route deployed (probably to a container), so, you better know what to expect there. There are <a href="https://github.com/apache/camel/tree/master/examples">endless example you can run</a>, so you will be easily find the one for your component too.</p><p>At this stage we should have enough clarity on what our component does, which is the expected URI structure and the expected configuration settings.</p><h6 id="changes-in-existing-camel-components">Changes in existing camel components</h6><p>If you are going to make any changes to the existing camel components, in order to be able to use them properly make sure to bring the correct version and to rebuild the <code>camel-catalog</code> dependency. This one is used at runtime by Syndesis to read configuration information such as the expected parameters, so, any change must be reflected by refreshing this dependency as well.</p><h3 id="maven-project-structure">Maven project structure</h3><p>As there is not yet an archetype available, we need to make some manual <code>pom.xml</code> configuration in order to prepare our project. In order to maintain the original structure of the project you will have to create a connector folder under the <code>app/connector</code> directory. In order to maintain the convention, call it <code>connector-nameOfComponent</code> (ie, <code>connector-mongodb</code>).</p><p>Next step is to create the minimum viable pom in order to be able to wrap all the needed dependencies for our connector.</p><h6 id="connector-description">Connector description</h6><p>Almost everything related to the project is managed by the connector parent pom. So, you just have to provide the name of this new dependency:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#999;font-weight:700;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#998;font-style:italic">&lt;!-- Copyright (C) 2016 Red Hat, Inc. Licensed under the Apache ...--&gt;</span>
<span style="color:navy">&lt;project</span> <span style="color:teal">xmlns=</span><span style="color:#d14">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span style="color:teal">xmlns:xsi=</span><span style="color:#d14">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span style="color:teal">xsi:schemaLocation=</span><span style="color:#d14">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span style="color:navy">&gt;</span>
    <span style="color:navy">&lt;parent&gt;</span>
        <span style="color:navy">&lt;groupId&gt;</span>io.syndesis.connector<span style="color:navy">&lt;/groupId&gt;</span>
        <span style="color:navy">&lt;artifactId&gt;</span>connector-parent<span style="color:navy">&lt;/artifactId&gt;</span>
        <span style="color:navy">&lt;version&gt;</span>1.7-SNAPSHOT<span style="color:navy">&lt;/version&gt;</span>
        <span style="color:navy">&lt;relativePath&gt;</span>../pom.xml<span style="color:navy">&lt;/relativePath&gt;</span>
    <span style="color:navy">&lt;/parent&gt;</span>

    <span style="color:navy">&lt;modelVersion&gt;</span>4.0.0<span style="color:navy">&lt;/modelVersion&gt;</span>
    <span style="color:navy">&lt;artifactId&gt;</span>connector-mongodb<span style="color:navy">&lt;/artifactId&gt;</span>
    <span style="color:navy">&lt;name&gt;</span>Connector :: MongoDB<span style="color:navy">&lt;/name&gt;</span>
    <span style="color:navy">&lt;packaging&gt;</span>jar<span style="color:navy">&lt;/packaging&gt;</span>
</pre></div><p>You will have to change the version and name of your connector accordingly. You will can find the latest version in the <code>app/pom.xml</code> parent pom.</p><h6 id="dependencies">Dependencies</h6><p>Next section is related to the dependencies. You can start with the basic ones and then iteratively adding the ones needed by your development:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>    <span style="color:navy">&lt;dependencies&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>org.apache.camel<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>camel-core<span style="color:navy">&lt;/artifactId&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>io.syndesis.common<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>common-model<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>provided<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>org.slf4j<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>slf4j-api<span style="color:navy">&lt;/artifactId&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>io.syndesis.integration<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>integration-component-proxy<span style="color:navy">&lt;/artifactId&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>jackson-databind<span style="color:navy">&lt;/artifactId&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>org.mongodb<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>mongo-java-driver<span style="color:navy">&lt;/artifactId&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
</pre></div><p>Of course you can skip the <code>mongodb</code> related dependencies in your development. We also want to include the testing dependencies that will help us in setting up all the unit test we will need:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>        <span style="color:#998;font-style:italic">&lt;!-- Testing --&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>junit<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>junit<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>        
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>org.apache.camel<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>camel-test<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>org.assertj<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>assertj-core<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>io.syndesis.connector<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>connector-support-test<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>com.github.spotbugs<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>spotbugs-annotations<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>org.hibernate.validator<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>hibernate-validator<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>org.glassfish<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>javax.el<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>ch.qos.logback<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>logback-classic<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>org.apache.camel<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>camel-mongodb3<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>runtime<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>de.flapdoodle.embed<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>de.flapdoodle.embed.mongo<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
        <span style="color:#998;font-style:italic">&lt;!-- Analyzer is requiring to explicit this dependency --&gt;</span>
        <span style="color:navy">&lt;dependency&gt;</span>
            <span style="color:navy">&lt;groupId&gt;</span>de.flapdoodle.embed<span style="color:navy">&lt;/groupId&gt;</span>
            <span style="color:navy">&lt;artifactId&gt;</span>de.flapdoodle.embed.process<span style="color:navy">&lt;/artifactId&gt;</span>
            <span style="color:navy">&lt;version&gt;</span>1.50.2<span style="color:navy">&lt;/version&gt;</span>
            <span style="color:navy">&lt;scope&gt;</span>test<span style="color:navy">&lt;/scope&gt;</span>
        <span style="color:navy">&lt;/dependency&gt;</span>
    <span style="color:navy">&lt;/dependencies&gt;</span>
</pre></div><p>The last three dependencies are specific to this sample development, the rest is needed by any generic test case. Please notice that in our first development we scope <code>camel-mongodb3</code> dependency as runtime: this is because during the first development we won’t make explicit use of this dependency, only the unit test and finally the integration will do that.</p><h6 id="plugins">Plugins</h6><p>The last part of the pom is related to the plugins configuration:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>    <span style="color:navy">&lt;build&gt;</span>
        <span style="color:navy">&lt;resources&gt;</span>
            <span style="color:navy">&lt;resource&gt;</span>
                <span style="color:navy">&lt;directory&gt;</span>src/main/resources<span style="color:navy">&lt;/directory&gt;</span>
                <span style="color:navy">&lt;filtering&gt;</span>true<span style="color:navy">&lt;/filtering&gt;</span>
            <span style="color:navy">&lt;/resource&gt;</span>
        <span style="color:navy">&lt;/resources&gt;</span>

        <span style="color:navy">&lt;plugins&gt;</span>
            <span style="color:navy">&lt;plugin&gt;</span>
                <span style="color:navy">&lt;artifactId&gt;</span>maven-resources-plugin<span style="color:navy">&lt;/artifactId&gt;</span>
                <span style="color:navy">&lt;configuration&gt;</span>
                    <span style="color:navy">&lt;delimiters&gt;</span>
                        <span style="color:navy">&lt;delimiter&gt;</span>@<span style="color:navy">&lt;/delimiter&gt;</span>
                    <span style="color:navy">&lt;/delimiters&gt;</span>
                <span style="color:navy">&lt;/configuration&gt;</span>
            <span style="color:navy">&lt;/plugin&gt;</span>

            <span style="color:navy">&lt;plugin&gt;</span>
                <span style="color:navy">&lt;groupId&gt;</span>io.syndesis.connector<span style="color:navy">&lt;/groupId&gt;</span>
                <span style="color:navy">&lt;artifactId&gt;</span>connector-support-maven-plugin<span style="color:navy">&lt;/artifactId&gt;</span>
                <span style="color:navy">&lt;executions&gt;</span>
                    <span style="color:navy">&lt;execution&gt;</span>
                        <span style="color:navy">&lt;id&gt;</span>inspections<span style="color:navy">&lt;/id&gt;</span>
                        <span style="color:navy">&lt;phase&gt;</span>process-classes<span style="color:navy">&lt;/phase&gt;</span>
                        <span style="color:navy">&lt;goals&gt;</span>
                            <span style="color:navy">&lt;goal&gt;</span>generate-connector-inspections<span style="color:navy">&lt;/goal&gt;</span>
                        <span style="color:navy">&lt;/goals&gt;</span>
                    <span style="color:navy">&lt;/execution&gt;</span>
                <span style="color:navy">&lt;/executions&gt;</span>
            <span style="color:navy">&lt;/plugin&gt;</span>
        <span style="color:navy">&lt;/plugins&gt;</span>
    <span style="color:navy">&lt;/build&gt;</span>
<span style="color:navy">&lt;/project&gt;</span>
</pre></div><p>You can make an exact copy of this part as we are introducing a utility that will help you setting up a descriptor configuration file through the execution of the phase highlighted in the code above.</p><p>At this stage you can set up your IDE in order to get the maven project and also execute <code>mvn install</code> to confirm that the structure of the project is fine (although empty).</p><h6 id="syndesis-cli">Syndesis CLI</h6><p>We will make use of <code>mvn</code> directly in order to see all low level details but there is a cool <a href="https://syndesis.io/docs/cli/">CLI for Syndesis</a> project with more advanced features that you may get familiarity with during your Syndesis development.</p><h3 id="json-schema-definition">JSON Schema definition</h3><p>Now that you have a valid maven structure you will have to define the descriptor information that describes your connector. The whole explanation of all the parameters is provided in a <a href="https://access.redhat.com/documentation/en-us/red_hat_fuse/7.3/html-single/integrating_applications_with_fuse_online/index#about-extension-definitions_extensions">dedicated document</a>. In the first iteration we will use just a few of them.</p><p>The connector support plugin mentioned in the previous chapter is going to take care of validating the structure of such descriptor that is expected to be found at <code>/META-INF/syndesis/connector</code> directory. Also recall the URI scheme of the component and create a json empty file named after it (in our example, <code>mongodb.json</code>).</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>$ mkdir -p src/main/resources/META-INF/syndesis/connector
$ touch src/main/resources/META-INF/syndesis/connector/mongodb.json
</pre></div><p>Let’s run now the validation and, since the descriptor is still empty, let’s expect an error too!</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#bbb"> </span>mvn<span style="color:#bbb"> </span>process<span style="color:#000;font-weight:700">-</span>classes<span style="color:#bbb"></span>
<span style="color:#a61717;background-color:#e3d2d2">…</span>.<span style="color:#bbb"></span>
<span style="color:#000;font-weight:700">[</span>ERROR<span style="color:#000;font-weight:700">]</span><span style="color:#bbb"> </span>Failed<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">to</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:700">execute</span><span style="color:#bbb"> </span>goal<span style="color:#bbb"> </span>io.syndesis.<span style="color:#900;font-weight:700">connector</span>:connector<span style="color:#000;font-weight:700">-</span>support<span style="color:#000;font-weight:700">-</span>maven<span style="color:#000;font-weight:700">-</span><span style="color:#900;font-weight:700">plugin</span>:<span style="color:#099">1.7</span><span style="color:#000;font-weight:700">-</span><span style="color:#900;font-weight:700">SNAPSHOT</span>:generate<span style="color:#000;font-weight:700">-</span>connector<span style="color:#000;font-weight:700">-</span>inspections<span style="color:#bbb"> </span>(inspections)<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">on</span><span style="color:#bbb"> </span>project<span style="color:#bbb"> </span>connector<span style="color:#000;font-weight:700">-</span><span style="color:#900;font-weight:700">mongodb</span>:<span style="color:#bbb"> </span>Execution<span style="color:#bbb"> </span>inspections<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">of</span><span style="color:#bbb"> </span>goal<span style="color:#bbb"> </span>io.syndesis.<span style="color:#900;font-weight:700">connector</span>:connector<span style="color:#000;font-weight:700">-</span>support<span style="color:#000;font-weight:700">-</span>maven<span style="color:#000;font-weight:700">-</span><span style="color:#900;font-weight:700">plugin</span>:<span style="color:#099">1.7</span><span style="color:#000;font-weight:700">-</span><span style="color:#900;font-weight:700">SNAPSHOT</span>:generate<span style="color:#000;font-weight:700">-</span>connector<span style="color:#000;font-weight:700">-</span>inspections<span style="color:#bbb"> </span><span style="color:#900;font-weight:700">failed</span>:<span style="color:#bbb"> </span>unhandled<span style="color:#bbb"> </span>token<span style="color:#bbb"> </span>type<span style="color:#bbb"> </span>NOT_AVAILABLE<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">-&gt;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:700">[</span>Help 1<span style="color:#000;font-weight:700">]</span><span style="color:#bbb"></span>
</pre></div><p>No fear. The plugin is your friend and is there to drive you through the correct development of the connector notifying any configuration error. We are going to fix in a minute.</p><h4 id="basic-descriptor">Basic descriptor</h4><p>The goal of the descriptor is to provide to Syndesis enough information on which are the expected parameters that are needed by the upstream component in order to create a route and be able to properly create endpoints with such configuration. Here you have to retake the analysis you did when you selected your components and recall all those options required and the one you want to provide in order to customize in on Syndesis. I will split the configuration to ease the explanation:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">{</span>
  <span style="color:#990073">&quot;description&quot;</span>: <span style="color:#990073">&quot;Mongo DB connector.&quot;</span>,
  <span style="color:#990073">&quot;icon&quot;</span>: <span style="color:#990073">&quot;assets:mongodb.png&quot;</span>,
  <span style="color:#990073">&quot;id&quot;</span>: <span style="color:#990073">&quot;mongodb&quot;</span>,
  <span style="color:#990073">&quot;name&quot;</span>: <span style="color:#990073">&quot;MongoDB&quot;</span>,
  <span style="color:#990073">&quot;properties&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
    <span style="color:#990073">&quot;host&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
      <span style="color:#990073">&quot;componentProperty&quot;</span>: <span style="color:#000;font-weight:700">true</span>,
      <span style="color:#990073">&quot;deprecated&quot;</span>: <span style="color:#000;font-weight:700">false</span>,
      <span style="color:#990073">&quot;displayName&quot;</span>: <span style="color:#990073">&quot;Database host&quot;</span>,
      <span style="color:#990073">&quot;group&quot;</span>: <span style="color:#990073">&quot;common&quot;</span>,
      <span style="color:#990073">&quot;javaType&quot;</span>: <span style="color:#990073">&quot;java.lang.String&quot;</span>,
      <span style="color:#990073">&quot;kind&quot;</span>: <span style="color:#990073">&quot;property&quot;</span>,
      <span style="color:#990073">&quot;label&quot;</span>: <span style="color:#990073">&quot;&quot;</span>,
      <span style="color:#990073">&quot;labelHint&quot;</span>: <span style="color:#990073">&quot;Database host.&quot;</span>,
      <span style="color:#990073">&quot;order&quot;</span>: <span style="color:#990073">&quot;1&quot;</span>,
      <span style="color:#990073">&quot;required&quot;</span>: <span style="color:#000;font-weight:700">true</span>,
      <span style="color:#990073">&quot;secret&quot;</span>: <span style="color:#000;font-weight:700">false</span>,
      <span style="color:#990073">&quot;tags&quot;</span>: [],
      <span style="color:#990073">&quot;type&quot;</span>: <span style="color:#990073">&quot;string&quot;</span>
    <span style="color:#a61717;background-color:#e3d2d2">}</span>
  <span style="color:#a61717;background-color:#e3d2d2">}</span>,
</pre></div><p>This first part describes the information such as a name you want to assign to this connector and the possibility to include an icon embedded as base64. An important part to understand is represented by the properties that represent which are the common configuration expected by this component. In general you may expect here to have information on how to connect to a certain datasource: in my example I just need to identify the host where the database is located, assuming the default port and public access to the db. In a second iteration I will add those properties there as well.</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>  <span style="color:#990073">&quot;actions&quot;</span>: [
    <span style="color:#a61717;background-color:#e3d2d2">{</span>
      <span style="color:#990073">&quot;actionType&quot;</span>: <span style="color:#990073">&quot;connector&quot;</span>,
      <span style="color:#990073">&quot;description&quot;</span>: <span style="color:#990073">&quot;Mongo DB producer&quot;</span>,
      <span style="color:#990073">&quot;descriptor&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
        <span style="color:#990073">&quot;componentScheme&quot;</span>: <span style="color:#990073">&quot;mongodb&quot;</span>,     
        <span style="color:#990073">&quot;inputDataShape&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
          <span style="color:#990073">&quot;kind&quot;</span>: <span style="color:#990073">&quot;json-schema&quot;</span>
        <span style="color:#a61717;background-color:#e3d2d2">}</span>,
        <span style="color:#990073">&quot;outputDataShape&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
          <span style="color:#990073">&quot;kind&quot;</span>: <span style="color:#990073">&quot;json-schema&quot;</span>
        <span style="color:#a61717;background-color:#e3d2d2">}</span>
      <span style="color:#a61717;background-color:#e3d2d2">}</span>,
      <span style="color:#990073">&quot;id&quot;</span>: <span style="color:#990073">&quot;io.syndesis.connector:connector-mongodb-producer&quot;</span>,
      <span style="color:#990073">&quot;name&quot;</span>: <span style="color:#990073">&quot;Mongo DB producer&quot;</span>,
      <span style="color:#990073">&quot;pattern&quot;</span>: <span style="color:#990073">&quot;To&quot;</span>,
      <span style="color:#990073">&quot;propertyDefinitionSteps&quot;</span>: [
          <span style="color:#a61717;background-color:#e3d2d2">{</span>
            <span style="color:#990073">&quot;description&quot;</span>: <span style="color:#990073">&quot;Enter a database.&quot;</span>,
            <span style="color:#990073">&quot;name&quot;</span>: <span style="color:#990073">&quot;Database&quot;</span>,
            <span style="color:#990073">&quot;properties&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
              <span style="color:#990073">&quot;database&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
                <span style="color:#990073">&quot;deprecated&quot;</span>: <span style="color:#000;font-weight:700">false</span>,
                <span style="color:#990073">&quot;displayName&quot;</span>: <span style="color:#990073">&quot;Database name&quot;</span>,
                <span style="color:#990073">&quot;group&quot;</span>: <span style="color:#990073">&quot;common&quot;</span>,
                <span style="color:#990073">&quot;javaType&quot;</span>: <span style="color:#990073">&quot;java.lang.String&quot;</span>,
                <span style="color:#990073">&quot;kind&quot;</span>: <span style="color:#990073">&quot;path&quot;</span>,
                <span style="color:#990073">&quot;labelHint&quot;</span>: <span style="color:#990073">&quot;Database name&quot;</span>,
                <span style="color:#990073">&quot;placeholder&quot;</span>: <span style="color:#990073">&quot;database&quot;</span>,
                <span style="color:#990073">&quot;required&quot;</span>: <span style="color:#000;font-weight:700">true</span>,
                <span style="color:#990073">&quot;secret&quot;</span>: <span style="color:#000;font-weight:700">false</span>,
                <span style="color:#990073">&quot;type&quot;</span>: <span style="color:#990073">&quot;string&quot;</span>
              <span style="color:#a61717;background-color:#e3d2d2">}</span>,
              <span style="color:#990073">&quot;collection&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
                <span style="color:#990073">&quot;deprecated&quot;</span>: <span style="color:#000;font-weight:700">false</span>,
...
                <span style="color:#990073">&quot;type&quot;</span>: <span style="color:#990073">&quot;string&quot;</span>
              <span style="color:#a61717;background-color:#e3d2d2">}</span>,
              <span style="color:#990073">&quot;operation&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
                <span style="color:#990073">&quot;deprecated&quot;</span>: <span style="color:#000;font-weight:700">false</span>,
...
                <span style="color:#990073">&quot;type&quot;</span>: <span style="color:#990073">&quot;string&quot;</span>
              <span style="color:#a61717;background-color:#e3d2d2">}</span>              
            <span style="color:#a61717;background-color:#e3d2d2">}</span>
        <span style="color:#a61717;background-color:#e3d2d2">}</span>    
        ]
    <span style="color:#a61717;background-color:#e3d2d2">}</span>    
  ],
</pre></div><p>The second part of the descriptor is where we introduce to provide the expected behavior of our component. We can define “actions” that are going to be performed over the connection according to the pattern specified (mainly <code>From</code> for a consumer and <code>To</code> for a producer type - also <code>Pipe</code> exists and can be configured).</p><p>Here we just want to use the connector as a producer of data in order to perform certain operations as final result of a route. As an example, we want to get data from a certain source (a sql db, your twitter mentions, …) and write to a mongoDB database and collection.</p><p>In order to perform such operation I need to know the following 3 parameters: <code>database</code>, <code>collection</code> and <code>operation</code>. Therefore in the <code>propertiesDefinitionStep</code> we include them. The runtime result will be that we’re going to be prompted from the GUI to provide those configuration every time that we’ll create a new integration on Syndesis.</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>  <span style="color:#d14">&quot;dependencies&quot;</span><span style="color:#000;font-weight:700">:</span> [
    {
      <span style="color:#d14">&quot;id&quot;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#d14">&quot;@project.groupId@:@project.artifactId@:@project.version@&quot;</span>,
      <span style="color:#d14">&quot;type&quot;</span><span style="color:#000;font-weight:700">:</span> <span style="color:#d14">&quot;MAVEN&quot;</span>
    }
  ]
}
</pre></div><p>The last part of the descriptor is used to declare maven dependencies. The above one should work from most of the case if the development conventions are respected.</p><h3 id="unit-test-preparation">Unit test preparation</h3><p>At this stage we have our connector, so, we can even try to include in Syndesis bundle, deploy and make a real integration. However, a better strategy is to make some unit test in order to verify that our integration is not going to fail and to serve as regression for the future.</p><p>There is a class you have to extend in order to benefit all the environment provided by Syndesis and Camel and just worry about making your testsuite: <a href="https://github.com/syndesisio/syndesis/blob/master/app/connector/support/test/src/main/java/io/syndesis/connector/support/test/ConnectorTestSupport.java">io.syndesis.connector.support.test.ConnectorTestSupport</a> that is extending the upstream Camel supporting test class <a href="https://github.com/apache/camel/blob/master/components/camel-test/src/main/java/org/apache/camel/test/junit4/CamelTestSupport.java">org.apache.camel.test.junit4.CamelTestSupport</a>.</p><p>As long as you progress with the development of your test suit you will be able to discover all the features offered by these 2 classes. For the first iteration you will have to just provide the implementation of an abstract method that would take care of building the final route (involving your connector too!). Here is a simple test for the MongoDB:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>@<span style="color:teal">Override</span>
<span style="color:teal">protected</span> <span style="color:teal">List</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">Step</span><span style="color:#000;font-weight:700">&gt;</span> <span style="color:teal">createSteps</span><span style="color:#990073">()</span> {
    <span style="color:#000;font-weight:700">return</span> <span style="color:teal">Arrays</span>.<span style="color:teal">asList</span><span style="color:#990073">(</span>
            <span style="color:teal">newSimpleEndpointStep</span><span style="color:#990073">(</span><span style="color:#d14">&quot;direct&quot;</span>, <span style="color:teal">builder</span> <span style="color:#000;font-weight:700">-&gt;</span> <span style="color:teal">builder</span>.<span style="color:teal">putConfiguredProperty</span><span style="color:#990073">(</span><span style="color:#d14">&quot;name&quot;</span>, <span style="color:#d14">&quot;start&quot;</span><span style="color:#990073">))</span>,
            <span style="color:teal">newEndpointStep</span><span style="color:#990073">(</span><span style="color:#d14">&quot;mongodb&quot;</span>, <span style="color:#d14">&quot;io.syndesis.connector:connector-mongodb-producer&quot;</span>,
                <span style="color:teal">builder</span> <span style="color:#000;font-weight:700">-&gt;</span> {},
                <span style="color:teal">builder</span> <span style="color:#000;font-weight:700">-&gt;</span> {
                    <span style="color:teal">builder</span>.<span style="color:teal">putConfiguredProperty</span><span style="color:#990073">(</span><span style="color:#d14">&quot;connectionBean&quot;</span>, <span style="color:#d14">&quot;connectionBeanContextRef&quot;</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
                    <span style="color:teal">builder</span>.<span style="color:teal">putConfiguredProperty</span><span style="color:#990073">(</span><span style="color:#d14">&quot;database&quot;</span>, <span style="color:teal">DATABASE</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
                    <span style="color:teal">builder</span>.<span style="color:teal">putConfiguredProperty</span><span style="color:#990073">(</span><span style="color:#d14">&quot;collection&quot;</span>, <span style="color:teal">COLLECTION</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
                    <span style="color:teal">builder</span>.<span style="color:teal">putConfiguredProperty</span><span style="color:#990073">(</span><span style="color:#d14">&quot;operation&quot;</span>, <span style="color:#d14">&quot;insert&quot;</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
                }<span style="color:#990073">)</span>
            <span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
}
</pre></div><p>The mother class will use this method in order to build a route that would consume from a <a href="https://camel.apache.org/direct.html">direct component</a> named start and produce to the mongodb component through the usage of the connector we’ve just created. Please notice that we are configuring a connector endpoint with the identification provided in the json descriptor and passing the map of parameters expected by the implementation: <code>database</code>, <code>collection</code> and <code>operation</code> (this component expect a further one named <code>connectionBean</code>, we’ll come back to this in a while).</p><p>The last step is to provide the test case, here one as a reference:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>@<span style="color:teal">Test</span>
<span style="color:teal">public</span> <span style="color:teal">void</span> <span style="color:teal">mongoInsertTest</span><span style="color:#990073">()</span> {
    <span style="color:#000;font-weight:700">//</span> <span style="color:teal">When</span>
    <span style="color:#000;font-weight:700">//</span> <span style="color:teal">Given</span>
    <span style="color:teal">String</span> <span style="color:teal">uniqueId</span> <span style="color:#000;font-weight:700">=</span> <span style="color:teal">UUID</span>.<span style="color:teal">randomUUID</span><span style="color:#990073">()</span>.<span style="color:teal">toString</span><span style="color:#990073">()</span><span style="color:#998;font-style:italic">;</span>
    <span style="color:teal">String</span> <span style="color:teal">message</span> <span style="color:#000;font-weight:700">=</span> <span style="color:teal">String</span>.<span style="color:teal">format</span><span style="color:#990073">(</span><span style="color:#d14">&quot;{\&quot;</span><span style="color:teal">test</span>\<span style="color:#d14">&quot;:\&quot;</span><span style="color:teal">unit</span>\<span style="color:#d14">&quot;,\&quot;</span><span style="color:teal">uniqueId</span>\<span style="color:#d14">&quot;:\&quot;</span><span style="color:#000;font-weight:700">%</span><span style="color:teal">s</span>\<span style="color:#d14">&quot;}&quot;</span>, <span style="color:teal">uniqueId</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
    <span style="color:teal">template</span><span style="color:#990073">()</span>.<span style="color:teal">sendBody</span><span style="color:#990073">(</span><span style="color:#d14">&quot;direct:start&quot;</span>, <span style="color:teal">message</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
    <span style="color:#000;font-weight:700">//</span> <span style="color:#000;font-weight:700">Then</span>
    <span style="color:teal">List</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">Document</span><span style="color:#000;font-weight:700">&gt;</span> <span style="color:teal">docsFound</span> <span style="color:#000;font-weight:700">=</span> <span style="color:teal">collection</span>.<span style="color:teal">find</span><span style="color:#990073">(</span><span style="color:teal">Filters</span>.<span style="color:teal">eq</span><span style="color:#990073">(</span><span style="color:#d14">&quot;uniqueId&quot;</span>, <span style="color:teal">uniqueId</span><span style="color:#990073">))</span>.<span style="color:teal">into</span><span style="color:#990073">(</span><span style="color:teal">new</span> <span style="color:teal">ArrayList</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">Document</span><span style="color:#000;font-weight:700">&gt;</span><span style="color:#990073">())</span><span style="color:#998;font-style:italic">;</span>
    <span style="color:teal">assertEquals</span><span style="color:#990073">(</span><span style="color:#099">1</span>, <span style="color:teal">docsFound</span>.<span style="color:teal">size</span><span style="color:#990073">())</span><span style="color:#998;font-style:italic">;</span>
}
</pre></div><p>In order to kick off the integration we will use the <code>template()</code> method offered by the super class, providing as a body a simple json text with a unique field in it. We do expect that the route configured above would use the insert operation to write this json into the database and the collection specified. As a simple assert condition we verify that the content of a json field corresponds to the one that the same test has produced.</p><p>In your development you may use a similar strategy when you need to produce some data to your connector and an approach with <a href="http://camel.apache.org/mock.html">Mock component</a> when you need to consume data from your connector.</p><h6 id="connection-bean">Connection Bean</h6><p>To have a complete test you will need the possibility to either mock the service that is providing the connection to your component or a real instance of it. In the example it translates into a real instance of MongoDB to connect to (or an embedded instance of a MongoDB).</p><p>Depending on the component you’re going to use you may expect to create some sort of connection on demand or to pass it through properties or context configuration. In the example proposed here, the component is expecting a connection bean to be available in Camel Context:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:teal">@Override</span><span style="color:#bbb"></span>
<span style="color:#000;font-weight:700">public</span><span style="color:#bbb"> </span>void<span style="color:#bbb"> </span>postProcessTest()<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">{</span><span style="color:#bbb"></span>
<span style="color:#bbb">    </span>MongoClient<span style="color:#bbb"> </span>mongoClient<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:700">new</span><span style="color:#bbb"> </span>MongoClient(<span style="color:#990073">&quot;localhost&quot;</span>);<span style="color:#bbb"></span>
<span style="color:#bbb">    </span>context().getRegistry(JndiRegistry.<span style="color:#000;font-weight:700">class</span>).bind(<span style="color:#990073">&quot;mongoConnection&quot;</span>,<span style="color:#bbb"> </span>mongoClient);<span style="color:#bbb"></span>
<span style="color:#a61717;background-color:#e3d2d2">}</span><span style="color:#bbb"></span>
</pre></div><p>The method used here is inherited from the <code>CamelTestSupport</code> class and it’s called as soon a context has been created. What we’re doing is to wire a bean with a reference that will be looked up at runtime by the <code>camel-mongodb3</code> component.</p><h3 id="customization-development">Customization development</h3><p>The goal of this first part of the tutorial is to show how to possibly make an integration without adding any customization or further functionality to the upstream component. There may be certain connector that would not require anything else and they would work just setting the proper configuration through the descriptor and defining the proper actions.</p><p>However we do expect some sort of customization almost always because we likely have to deal with connection configuration as our components are typically bound to services responding to certain protocols. As an example, the development done so far would work only for test because it expects such a connection bean injected before to execute the integration. This is a typical use case that call out for a custom connector integration.</p><p>We will see two different approaches when you want to perform a connector customization taking as a reference the need to configure directly in the connector a connection bean.</p><p>As soon as you start the customization you may need to change the scope of the camel component in your maven configuration to be available at compile time (remind, at the beginning we scoped <code>camel-mongodb3</code> as runtime).</p><h5 id="customizer">Customizer</h5><p>The connector proxy development expected by Syndesis has taken in consideration the possibility to include any customization during the lifecycle of the connector action you’ve configured. Recall the configuration we’ve provided above: here we can introduce a new variable named connectorCustomizers whose goal is to enrich the behavior of the connector when that is created:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">{</span>
  <span style="color:#990073">&quot;actions&quot;</span>: [
    <span style="color:#a61717;background-color:#e3d2d2">{</span>
      <span style="color:#990073">&quot;actionType&quot;</span>: <span style="color:#990073">&quot;connector&quot;</span>,
      <span style="color:#990073">&quot;description&quot;</span>: <span style="color:#990073">&quot;Mongo DB to&quot;</span>,
      <span style="color:#990073">&quot;descriptor&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
        <span style="color:#990073">&quot;componentScheme&quot;</span>: <span style="color:#990073">&quot;mongodb&quot;</span>,
        <span style="color:#990073">&quot;connectorCustomizers&quot;</span>: [
          <span style="color:#990073">&quot;io.syndesis.connector.mongo.MongoCustomizer&quot;</span>
        ],        
...
      <span style="color:#990073">&quot;id&quot;</span>: <span style="color:#990073">&quot;io.syndesis.connector:connector-mongodb-to&quot;</span>,
      <span style="color:#990073">&quot;name&quot;</span>: <span style="color:#990073">&quot;Mongo to&quot;</span>,
      <span style="color:#990073">&quot;pattern&quot;</span>: <span style="color:#990073">&quot;To&quot;</span>
    <span style="color:#a61717;background-color:#e3d2d2">}</span>
</pre></div><p>What Syndesis connector is expecting there is an implementation of the <a href="https://github.com/syndesisio/syndesis/blob/master/app/integration/component-proxy/src/main/java/io/syndesis/integration/component/proxy/ComponentProxyCustomizer.java">io.syndesis.integration.component.proxy.ComponentProxyCustomizer</a> functional interface. Let’s illustrate it through the example:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:teal">public</span> <span style="color:teal">class</span> <span style="color:teal">MongoCustomizer</span> <span style="color:teal">implements</span> <span style="color:teal">ComponentProxyCustomizer</span>, <span style="color:teal">CamelContextAware</span> {
    <span style="color:teal">private</span> <span style="color:teal">CamelContext</span> <span style="color:teal">camelContext</span><span style="color:#998;font-style:italic">;</span>
...
    @<span style="color:teal">Override</span>
    <span style="color:teal">public</span> <span style="color:teal">void</span> <span style="color:teal">customize</span><span style="color:#990073">(</span><span style="color:teal">ComponentProxyComponent</span> <span style="color:teal">component</span>, <span style="color:teal">Map</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">String</span>, <span style="color:teal">Object</span><span style="color:#000;font-weight:700">&gt;</span> <span style="color:teal">options</span><span style="color:#990073">)</span> {
        <span style="color:#000;font-weight:700">if</span> <span style="color:#990073">(</span><span style="color:#000;font-weight:700">!</span><span style="color:teal">options</span>.<span style="color:teal">containsKey</span><span style="color:#990073">(</span><span style="color:#d14">&quot;connectionBean&quot;</span><span style="color:#990073">))</span> {
            <span style="color:teal">try</span> {
                <span style="color:teal">String</span> <span style="color:teal">host</span> <span style="color:#000;font-weight:700">=</span> <span style="color:#990073">(</span><span style="color:teal">String</span><span style="color:#990073">)</span> <span style="color:teal">options</span>.<span style="color:teal">get</span><span style="color:#990073">(</span><span style="color:#d14">&quot;host&quot;</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
                <span style="color:teal">MongoClient</span> <span style="color:teal">mongoClient</span> <span style="color:#000;font-weight:700">=</span> <span style="color:teal">new</span> <span style="color:teal">MongoClient</span><span style="color:#990073">(</span><span style="color:teal">host</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
                 <span style="color:teal">options</span>.<span style="color:teal">put</span><span style="color:#990073">(</span><span style="color:#d14">&quot;mongoConnection&quot;</span>, <span style="color:teal">mongoClient</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
            } <span style="color:teal">catch</span> <span style="color:#990073">(</span>@<span style="color:teal">SuppressWarnings</span><span style="color:#990073">(</span><span style="color:#d14">&quot;PMD.AvoidCatchingGenericException&quot;</span><span style="color:#990073">)</span> <span style="color:teal">Exception</span> <span style="color:teal">e</span><span style="color:#990073">)</span> {
                <span style="color:teal">throw</span> <span style="color:teal">new</span> <span style="color:teal">IllegalArgumentException</span><span style="color:#990073">(</span><span style="color:teal">e</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
            }
        }
    }
</pre></div><p>The customize method is the one that will take care to get information on the <code>host</code> (provided as a connection parameter of your connector json!), create a connection and inject the connection into the bean reference expected by the component.</p><p>Typically you will have to provide a similar implementation in order to set up the proper connection settings or if by any chance you need to transform the parameters passed by your user in something else.</p><p>One thing you may notice is that in this example we’ve implemented the <code>CamelContextAware</code> interface whose goal is to wire the runtime Camel context into this class and make it available for anything you may need to do with it. This is something you may not need to do.</p><p>As soon as this change is applied we can change the test case removing the context injection and setting the host in the properties passed into the connector:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>...
builder <span style="color:#000;font-weight:700">-&gt;</span> <span style="color:#a61717;background-color:#e3d2d2">{</span>
    builder.putConfiguredProperty(<span style="color:#990073">&quot;connectionBean&quot;</span>, <span style="color:#990073">&quot;connectionBeanContextRef&quot;</span>);
builder.putConfiguredProperty(<span style="color:#990073">&quot;host&quot;</span>, <span style="color:#a61717;background-color:#e3d2d2">“</span>localhost<span style="color:#a61717;background-color:#e3d2d2">”</span>);
    builder.putConfiguredProperty(<span style="color:#990073">&quot;database&quot;</span>, <span style="color:#000;font-weight:700">DATABASE</span>);
...
</pre></div><p>This is now ready to be tested in a real Syndesis integration!</p><h6 id="multiple-connector-customizer">Multiple connector customizer</h6><p>We’ve described how to use a connector customizer specific of a certain action. It means that if you have several actions using the same connection customizer you should copy the same configuration in all the actions. In order to prevent this you can configure this behavior on the generic connector configuration and even have more than one customizer at a time. As an example here you can see a configuration where we defined a specific operation customizer and a generic connector customizer:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">{</span>
  <span style="color:#990073">&quot;actions&quot;</span>: [
    <span style="color:#a61717;background-color:#e3d2d2">{</span>
...
        <span style="color:#990073">&quot;connectorCustomizers&quot;</span>: [
          <span style="color:#990073">&quot;io.syndesis.connector.mongo.MongoOperationCustomizer&quot;</span>
        ],        
...
      <span style="color:#990073">&quot;pattern&quot;</span>: <span style="color:#990073">&quot;From&quot;</span>
    <span style="color:#a61717;background-color:#e3d2d2">}</span>    
  ],
  <span style="color:#990073">&quot;configuredProperties&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{}</span>,
  <span style="color:#990073">&quot;connectorCustomizers&quot;</span>: [
    <span style="color:#990073">&quot;io.syndesis.connector.mongo.MongoClientCustomizer&quot;</span>
  ],   
  <span style="color:#990073">&quot;description&quot;</span>: <span style="color:#990073">&quot;Mongo DB connector.&quot;</span>,
...
<span style="color:#a61717;background-color:#e3d2d2">}</span>
</pre></div><p>You can notice the presence of two different customizer that can work together to customize either a general behavior or a specific one bound to an action.</p><h5 id="componentdelegate">ComponentDelegate</h5><p>A second approach to customization is possible through the definition of a component delegate, whose goal is to have a more advanced control on the whole lifecycle of the component itself thanks to the presence of a series of customizable methods.</p><p>Let’s retake the first json descriptor and let’s add a new parameter:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>{
  <span style="color:#a61717;background-color:#e3d2d2">&quot;description&quot;:</span> <span style="color:#a61717;background-color:#e3d2d2">&quot;Mongo</span> <span style="color:#a61717;background-color:#e3d2d2">DB</span> <span style="color:#a61717;background-color:#e3d2d2">connector.&quot;,</span>
  <span style="color:#a61717;background-color:#e3d2d2">&quot;connectorFactory&quot;:</span> <span style="color:#a61717;background-color:#e3d2d2">&quot;io.syndesis.connector.mongo.MongoConnectorFactory&quot;,</span>
  <span style="color:#a61717;background-color:#e3d2d2">&quot;icon&quot;:</span> <span style="color:#a61717;background-color:#e3d2d2">&quot;</span>data:image<span style="color:#000;font-weight:700">/</span>svg<span style="color:#000;font-weight:700">+</span>xml;<span style="color:#a61717;background-color:#e3d2d2">base64,aFancyBase64CodeHere!!</span><span style="color:#999;font-weight:700;font-style:italic">[</span>...<span style="color:#999;font-weight:700;font-style:italic">]</span><span style="color:#a61717;background-color:#e3d2d2">&quot;,</span>
  <span style="color:#a61717;background-color:#e3d2d2">&quot;id&quot;:</span> <span style="color:#a61717;background-color:#e3d2d2">&quot;mongodb&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">…</span>
</pre></div><p>With this configuration we’re telling Syndesis connector manager to call this component factory (which implements <a href="https://github.com/syndesisio/syndesis/blob/master/app/integration/component-proxy/src/main/java/io/syndesis/integration/component/proxy/ComponentProxyFactory.java">ComponentProxyFactory</a>) whenever it has to create a new connector:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:teal">public</span> <span style="color:teal">class</span> <span style="color:teal">MongoConnectorFactory</span> <span style="color:teal">implements</span> <span style="color:teal">ComponentProxyFactory</span>{
    @<span style="color:teal">Override</span>
    <span style="color:teal">public</span> <span style="color:teal">ComponentProxyComponent</span> <span style="color:teal">newInstance</span><span style="color:#990073">(</span><span style="color:teal">String</span> <span style="color:teal">componentId</span>, <span style="color:teal">String</span> <span style="color:teal">componentScheme</span><span style="color:#990073">)</span> {
        <span style="color:#000;font-weight:700">return</span> <span style="color:teal">new</span> <span style="color:teal">MongoConnector</span><span style="color:#990073">(</span><span style="color:teal">componentId</span>,<span style="color:teal">componentScheme</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
    }
}
</pre></div><p>The real logic is actually developed from the connector class that have to extend the <a href="https://github.com/syndesisio/syndesis/blob/master/app/integration/component-proxy/src/main/java/io/syndesis/integration/component/proxy/ComponentProxyComponent.java">ComponentProxyComponent</a> class whose goal is to provide the integration with the camel component. If you don’t specify any customization, this default class is the one that will be used behind the scene by Syndesis connector.</p><p>Let’s see through an example how we can perform the customization needed by our component (ie providing a connection bean available at runtime):</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>@<span style="color:teal">SuppressWarnings</span><span style="color:#990073">(</span><span style="color:#d14">&quot;PMD.SignatureDeclareThrowsException&quot;</span><span style="color:#990073">)</span>
@<span style="color:teal">Override</span>
<span style="color:teal">protected</span> <span style="color:teal">Map</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">String</span>, <span style="color:teal">String</span><span style="color:#000;font-weight:700">&gt;</span> <span style="color:teal">buildEndpointOptions</span><span style="color:#990073">(</span><span style="color:teal">String</span> <span style="color:teal">remaining</span>, <span style="color:teal">Map</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">String</span>, <span style="color:teal">Object</span><span style="color:#000;font-weight:700">&gt;</span> <span style="color:teal">options</span><span style="color:#990073">)</span> <span style="color:teal">throws</span> <span style="color:teal">Exception</span> {
    <span style="color:#000;font-weight:700">if</span><span style="color:#990073">(</span><span style="color:teal">this</span>.<span style="color:teal">getCamelContext</span><span style="color:#990073">()</span>.<span style="color:teal">getRegistry</span><span style="color:#990073">()</span>.<span style="color:teal">lookup</span><span style="color:#990073">(</span><span style="color:teal">remaining</span><span style="color:#990073">)</span> <span style="color:#000;font-weight:700">==</span> <span style="color:teal">null</span><span style="color:#990073">)</span>{
        <span style="color:teal">String</span> <span style="color:teal">host</span> <span style="color:#000;font-weight:700">=</span> <span style="color:#990073">(</span><span style="color:teal">String</span><span style="color:#990073">)</span> <span style="color:teal">options</span>.<span style="color:teal">get</span><span style="color:#990073">(</span><span style="color:#d14">&quot;host&quot;</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
       <span style="color:teal">MongoClient</span> <span style="color:teal">mongoClient</span> <span style="color:#000;font-weight:700">=</span> <span style="color:teal">new</span> <span style="color:teal">MongoClient</span><span style="color:#990073">(</span><span style="color:teal">host</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
        <span style="color:teal">options</span>.<span style="color:teal">put</span><span style="color:#990073">(</span><span style="color:#d14">&quot;mongoConnection&quot;</span>, <span style="color:teal">mongoClient</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
    }
    <span style="color:#000;font-weight:700">return</span> <span style="color:teal">super</span>.<span style="color:teal">buildEndpointOptions</span><span style="color:#990073">(</span><span style="color:teal">remaining</span>, <span style="color:teal">options</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
}
</pre></div><p>The typical workflow however would expect to either create a complete new delegate component by extending the <code>createDelegateComponent(...)</code> method. You will find many connectors performing such operation. Another approach when you just have to deal with changes in the <code>Exchange</code> would be to use the pre/post producer and consumer processors available, here is an example:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:teal">MongoConnector</span><span style="color:#990073">(</span><span style="color:teal">String</span> <span style="color:teal">componentId</span>, <span style="color:teal">String</span> <span style="color:teal">componentScheme</span><span style="color:#990073">)</span> {
    <span style="color:teal">super</span><span style="color:#990073">(</span><span style="color:teal">componentId</span>, <span style="color:teal">componentScheme</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
    <span style="color:teal">this</span>.<span style="color:teal">setBeforeProducer</span><span style="color:#990073">(</span><span style="color:teal">this</span>::<span style="color:teal">beforeProduced</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
}

<span style="color:teal">public</span> <span style="color:teal">void</span> <span style="color:teal">beforeProduced</span><span style="color:#990073">(</span><span style="color:teal">Exchange</span> <span style="color:teal">exchange</span><span style="color:#990073">)</span> <span style="color:teal">throws</span> <span style="color:teal">Exception</span>{
       … <span style="color:#000;font-weight:700">do</span> <span style="color:teal">something</span> <span style="color:teal">with</span> <span style="color:teal">the</span> <span style="color:teal">Exchange</span>
}
</pre></div><p>As you can see, through delegate approach you have a higher degree of flexibility that should help you fixing most of the features you need to develop.</p><p>We can reuse the same unit test in order to verify that the component is working as expected and then make some real integration test on Syndesis.</p><h3 id="local-integration-test">Local integration test</h3><p>As soon as you’ve prepared your implementation and this has been tested properly through unit test, you will be able to integrate the new connector to the rest of components in Syndesis. The process would require you to edit a few <code>pom.xml</code> in order to let the different Syndesis modules know about the availability of this new component.</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>app<span style="color:#000;font-weight:700">/</span>connector<span style="color:#000;font-weight:700">/</span>pom.xml
app<span style="color:#000;font-weight:700">/</span>connector<span style="color:#000;font-weight:700">/</span>support<span style="color:#000;font-weight:700">/catalog/</span>pom.xml
app<span style="color:#000;font-weight:700">/</span>integration<span style="color:#000;font-weight:700">/</span>bom<span style="color:#000;font-weight:700">/</span>pom.xml
app<span style="color:#000;font-weight:700">/</span>integration<span style="color:#000;font-weight:700">/</span>bom<span style="color:#000;font-weight:700">-</span>camel<span style="color:#000;font-weight:700">-</span>k<span style="color:#000;font-weight:700">/</span>pom.xml
app<span style="color:#000;font-weight:700">/</span>meta<span style="color:#000;font-weight:700">/</span>pom.xml
app<span style="color:#000;font-weight:700">/</span>pom.xml
</pre></div><p>In the first pom (which is your connector parent pom) you must find the modules list and add an entry with your new module, whilst in the rest you must find the connector dependency list and just include your newly created dependency (plus the version in some of them, just copy a reference from another sample connector).</p><p>Try to maintain the alphabetical order so that it would be easier to spot any dependency when you’re looking for it.</p><p>You may now be able to execute the build of the whole syndesis either directly through mvn execution at base application path (app/pom.xml) or through the syndesis CLI. The second option is preferred as we will use shortly for deployment as well:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>$ syndesis build
</pre></div><p>The build will take some time as it compiles and test all the modules. There are several shortcut and flags you can use to accelerate this process, <a href="https://syndesis.io/docs/cli/">see guidelines here</a>.</p><h6 id="first-deployment">First deployment</h6><p>As soon as the build completed you are ready to deploy the application in your local minishift environment. You can run the following command to do so:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>$ syndesis minishift --install --local
</pre></div><p>You may take a base installation remotely if you don’t use the <code>--local</code> flag. You can also specify a base tag from where your installation starts (ie, <code>--tag 1.7</code>).</p><p>Make sure your minishift has started correctly (<code>$ minishift start</code>) and that you’ve logged in with proper development profiles (<code>$ oc login</code>) in order to grant the <code>fabric8</code> maven plugin the proper privileges either in first deployment and any following one.</p><h6 id="following-deployment">Following deployment</h6><p>Once your application is up and running, you may decide to make changes to the connector. So, after building and setting the proper dependencies in the poms mentioned above, you can refresh the local deployment with the new changes by updating 2 modules:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>$ syndesis build -f -i -m server
$ syndesis build -f -i -m s2i
</pre></div><p>The <code>server</code> component is taking care of setting the metadata used by the UI in order to configure your integration (ie, the parameters), whilst the <code>s2i</code> component is taking care of the creation of the Camel route itself by allowing the integration deploy to be bound to a docker image and deployed to the platform through the project-generator. Depending on the change you’ve performed you may need to build again also integration and meta or the same connector catalog. In such a situation it’s safer to rebuild the whole backend modules by running the following statement:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>$ syndesis build -f -i -b
</pre></div><p>The <code>-i</code> or <code>--image</code> flag will instruct your local installation to refresh the deployment on your local environment and be able therefore to apply the changes you’ve built.</p><h6 id="remote-deployment">Remote deployment</h6><p>Once you have all ready, tested and carefully reviewed, then, <a href="https://syndesis.io/community/contributing/#submitting-a-pull-request">proceed with a PR and follow the rest of the process</a>. As soon as the feature is merged on master you will be able to test your feature on the staging environment as well.</p><h3 id="connection-verifier">Connection verifier</h3><p>During the configuration of a new connection you will typically end up making requests to an external system with specific user credentials. Syndesis offers a feature to validate such connection parameters directly from the UI, so let’s see which are the development needed to make it happens.</p><p><mark>WARNING</mark>: you should consider adding the <code>verifier</code> on Syndesis instead of the camel upstream component only if there is any specific requirement that is impeding you to do that upstream. The normal process should be providing the verifier upstream first and later be able to just use the class from the verifier descriptor.</p><p>The first thing is to have a look at your json descriptor file and recall the id you’ve provided to the connector:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">…</span>
  <span style="color:#990073">&quot;id&quot;</span>: <span style="color:#990073">&quot;mongodb&quot;</span>,
<span style="color:#a61717;background-color:#e3d2d2">…</span>
</pre></div><p>Let’s create a new resource file following the structure here:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span>$ mkdir -p src/main/resources/META-INF/syndesis/connector/verifier
$ touch src/main/resources/META-INF/syndesis/connector/verifier/mongodb
</pre></div><p>The meta component will take care of looking that descriptor when invoked. The file will simply provide a configuration with the name of the class that you are going to develop:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#000;font-weight:700">class</span>=io.syndesis.connector.mongo.verifier.MongoDBVerifier
</pre></div><p>Then, the following step will be to develop the business logic expected according to a specific class we must extend:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:teal">public</span> <span style="color:teal">class</span> <span style="color:teal">MongoDBVerifier</span> <span style="color:teal">extends</span> <span style="color:teal">ComponentVerifier</span> {
   <span style="color:teal">public</span> <span style="color:teal">MongoDBVerifier</span><span style="color:#990073">()</span> {
       <span style="color:teal">super</span><span style="color:#990073">(</span><span style="color:#d14">&quot;mongodb&quot;</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
   }

   @<span style="color:teal">Override</span>
   <span style="color:teal">protected</span> <span style="color:teal">ComponentVerifierExtension</span> <span style="color:teal">resolveComponentVerifierExtension</span><span style="color:#990073">(</span><span style="color:teal">CamelContext</span> <span style="color:teal">context</span>, <span style="color:teal">String</span> <span style="color:teal">scheme</span><span style="color:#990073">)</span> {
       <span style="color:#000;font-weight:700">return</span> <span style="color:teal">new</span> <span style="color:teal">MongoConnectorVerifierExtension</span><span style="color:#990073">(</span><span style="color:teal">context</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
   }
}
</pre></div><p>Please notice that you are providing in the constructor, the name of your component (same of the verifier in this case). Finally we delegate the verification to a further class:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:teal">public</span> <span style="color:teal">class</span> <span style="color:teal">MongoConnectorVerifierExtension</span> <span style="color:teal">extends</span> <span style="color:teal">DefaultComponentVerifierExtension</span> {

   <span style="color:teal">public</span> <span style="color:teal">MongoConnectorVerifierExtension</span><span style="color:#990073">(</span><span style="color:teal">CamelContext</span> <span style="color:teal">camelContext</span><span style="color:#990073">)</span> {
       <span style="color:teal">super</span><span style="color:#990073">(</span><span style="color:#d14">&quot;mongodb&quot;</span>, <span style="color:teal">camelContext</span><span style="color:#990073">)</span><span style="color:#998;font-style:italic">;</span>
   }

   @<span style="color:teal">Override</span>
   <span style="color:teal">public</span> <span style="color:#0086b3">Result</span> <span style="color:teal">verifyParameters</span><span style="color:#990073">(</span><span style="color:teal">Map</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">String</span>, <span style="color:teal">Object</span><span style="color:#000;font-weight:700">&gt;</span> <span style="color:teal">parameters</span><span style="color:#990073">)</span> {
       <span style="color:teal">ResultBuilder</span> <span style="color:teal">builder</span> <span style="color:#000;font-weight:700">=</span> <span style="color:teal">ResultBuilder</span>.<span style="color:teal">withStatusAndScope</span><span style="color:#990073">(</span><span style="color:#0086b3">Result</span>.<span style="color:teal">Status</span>.<span style="color:teal">OK</span>, <span style="color:teal">Scope</span>.<span style="color:teal">PARAMETERS</span><span style="color:#990073">)</span>
               .<span style="color:teal">error</span><span style="color:#990073">(</span><span style="color:teal">ResultErrorHelper</span>.<span style="color:teal">requiresOption</span><span style="color:#990073">(</span><span style="color:#d14">&quot;host&quot;</span>, <span style="color:teal">parameters</span><span style="color:#990073">))</span>
       <span style="color:#000;font-weight:700">return</span> <span style="color:teal">builder</span>.<span style="color:teal">build</span><span style="color:#990073">()</span><span style="color:#998;font-style:italic">;</span>
   }

   @<span style="color:teal">Override</span>
   <span style="color:teal">public</span> <span style="color:#0086b3">Result</span> <span style="color:teal">verifyConnectivity</span><span style="color:#990073">(</span><span style="color:teal">Map</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">String</span>, <span style="color:teal">Object</span><span style="color:#000;font-weight:700">&gt;</span> <span style="color:teal">parameters</span><span style="color:#990073">)</span> {
       <span style="color:#000;font-weight:700">return</span> <span style="color:teal">ResultBuilder</span>.<span style="color:teal">withStatusAndScope</span><span style="color:#990073">(</span><span style="color:#0086b3">Result</span>.<span style="color:teal">Status</span>.<span style="color:teal">OK</span>, <span style="color:teal">Scope</span>.<span style="color:teal">CONNECTIVITY</span><span style="color:#990073">)</span>
               .<span style="color:teal">error</span><span style="color:#990073">(</span><span style="color:teal">parameters</span>, <span style="color:teal">this</span>::<span style="color:teal">verifyCredentials</span><span style="color:#990073">)</span>
               .<span style="color:teal">build</span><span style="color:#990073">()</span><span style="color:#998;font-style:italic">;</span>
   }

   <span style="color:teal">private</span> <span style="color:teal">void</span> <span style="color:teal">verifyCredentials</span><span style="color:#990073">(</span><span style="color:teal">ResultBuilder</span> <span style="color:teal">builder</span>, <span style="color:teal">Map</span><span style="color:#000;font-weight:700">&lt;</span><span style="color:teal">String</span>, <span style="color:teal">Object</span><span style="color:#000;font-weight:700">&gt;</span> <span style="color:teal">parameters</span><span style="color:#990073">)</span> {
       <span style="color:teal">try</span> <span style="color:#990073">(</span><span style="color:teal">MongoClient</span> <span style="color:teal">mongoClient</span> <span style="color:#000;font-weight:700">=</span> <span style="color:teal">new</span> <span style="color:teal">MongoClient</span><span style="color:#990073">(</span><span style="color:teal">parameters</span>.<span style="color:teal">get</span><span style="color:#990073">(</span><span style="color:#d14">&quot;host&quot;</span><span style="color:#990073">)))</span> {
           <span style="color:#000;font-weight:700">//</span> <span style="color:teal">Just</span> <span style="color:teal">ping</span> <span style="color:teal">the</span> <span style="color:teal">server</span>
           <span style="color:teal">mongoClient</span>.<span style="color:teal">getConnectPoint</span><span style="color:#990073">()</span><span style="color:#998;font-style:italic">;</span>
       } <span style="color:teal">catch</span> <span style="color:#990073">(</span><span style="color:teal">Exception</span> <span style="color:teal">e</span><span style="color:#990073">)</span> {
           <span style="color:teal">ResultErrorBuilder</span> <span style="color:teal">errorBuilder</span> <span style="color:#000;font-weight:700">=</span> <span style="color:teal">ResultErrorBuilder</span>.<span style="color:teal">withCodeAndDescription</span><span style="color:#990073">(</span>
                   <span style="color:teal">VerificationError</span>.<span style="color:teal">StandardCode</span>.<span style="color:teal">GENERIC</span>,
                   <span style="color:teal">e</span>.<span style="color:teal">getMessage</span><span style="color:#990073">())</span><span style="color:#998;font-style:italic">;</span>
           <span style="color:teal">builder</span>.<span style="color:teal">error</span><span style="color:#990073">(</span><span style="color:teal">errorBuilder</span>.<span style="color:teal">build</span><span style="color:#990073">())</span><span style="color:#998;font-style:italic">;</span>
       }
   }
}
</pre></div><p>Through the <code>verifyParameters</code> method you will check which are the mandatory parameters needed by your connection validation, in our sample case we just need the host parameter to perform the following <code>verifyConnectivity</code> which is in charge to perform a connection test against the host provided as a parameter.</p><p>Please, consider that we are using a further <code>verifyCredentials</code> method reference as we eventually will provide more advanced test than simply connecting to the server. In fact, although we are just catching a generic exception, we will likely want to catch different specialized exceptions and provide also specific message for every error we may face (authentication failed, network failures, files missing, …).</p><p>Last configuration you have to apply is adding a tag to let the GUI know to enable verification on this component:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span> <span style="color:#990073">&quot;id&quot;</span>: <span style="color:#990073">&quot;mongodb3&quot;</span>,
 <span style="color:#990073">&quot;name&quot;</span>: <span style="color:#990073">&quot;MongoDB&quot;</span>,
...
 <span style="color:#990073">&quot;tags&quot;</span>: [
   <span style="color:#990073">&quot;verifier&quot;</span>
 ]
<span style="color:#a61717;background-color:#e3d2d2">}</span>
</pre></div><h3 id="appendix-a-icons-and-metadata">Appendix A - Icons and metadata</h3><p>As you may have noticed, when we created the descriptor for the connector we referenced an image in the <code>icon</code> parameter. In order to provide this image available to the <code>UI</code> you will have to drop such image in the <code>app/ui-react/syndesis/public/icons/</code> folder.</p><p>Another useful flag you may be interested to use is the <code>Technology Preview</code> tag, that is generally used to identify some connector that lack certain features but that is already available to be used. Typically these connectors are made <code>General Available</code> in the following version of the product. This is the flag to use in such situations:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">{</span>
  <span style="color:#990073">&quot;version&quot;</span>: <span style="color:#099">4</span>,
  <span style="color:#990073">&quot;actions&quot;</span>: [
...
  <span style="color:#990073">&quot;id&quot;</span>: <span style="color:#990073">&quot;mongodb3&quot;</span>,
  <span style="color:#990073">&quot;metadata&quot;</span>: <span style="color:#a61717;background-color:#e3d2d2">{</span>
    <span style="color:#990073">&quot;tech-preview&quot;</span>: <span style="color:#000;font-weight:700">true</span>
  <span style="color:#a61717;background-color:#e3d2d2">}</span>,
  <span style="color:#990073">&quot;name&quot;</span>: <span style="color:#990073">&quot;MongoDB&quot;</span>, 
...
<span style="color:#a61717;background-color:#e3d2d2">}</span>
</pre></div><h3 id="reference-used">Reference used</h3><ul><li><a href="https://github.com/syndesisio/syndesis/blob/ed4f0f14e755a3cada1a18c95562b3f4a316fd6b/doc/integrating-applications/topics/r_develop-connector-extensions.adoc">Syndesis documentation</a></li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_fuse/7.3/html-single/integrating_applications_with_fuse_online/index#develop-connector-extensions_extensions">Fuse online documentation</a></li></ul></div></div></div><div class="toc hidden-md-down"><nav id="TableOfContents"><ul><li><ul><li><ul><li><a href="#tutorial">Tutorial</a></li><li><a href="#camel-upstream-component">Camel upstream component</a><ul><li><ul><li><ul><li><a href="#changes-in-existing-camel-components">Changes in existing camel components</a></li></ul></li></ul></li></ul></li><li><a href="#maven-project-structure">Maven project structure</a><ul><li><ul><li><ul><li><a href="#connector-description">Connector description</a></li><li><a href="#dependencies">Dependencies</a></li><li><a href="#plugins">Plugins</a></li><li><a href="#syndesis-cli">Syndesis CLI</a></li></ul></li></ul></li></ul></li><li><a href="#json-schema-definition">JSON Schema definition</a><ul><li><a href="#basic-descriptor">Basic descriptor</a></li></ul></li><li><a href="#unit-test-preparation">Unit test preparation</a><ul><li><ul><li><ul><li><a href="#connection-bean">Connection Bean</a></li></ul></li></ul></li></ul></li><li><a href="#customization-development">Customization development</a><ul><li><ul><li><a href="#customizer">Customizer</a><ul><li><a href="#multiple-connector-customizer">Multiple connector customizer</a></li></ul></li><li><a href="#componentdelegate">ComponentDelegate</a></li></ul></li></ul></li><li><a href="#local-integration-test">Local integration test</a><ul><li><ul><li><ul><li><a href="#first-deployment">First deployment</a></li><li><a href="#following-deployment">Following deployment</a></li><li><a href="#remote-deployment">Remote deployment</a></li></ul></li></ul></li></ul></li><li><a href="#connection-verifier">Connection verifier</a></li><li><a href="#appendix-a-icons-and-metadata">Appendix A - Icons and metadata</a></li><li><a href="#reference-used">Reference used</a></li></ul></li></ul></li></ul></nav></div></div><footer class="page-footer text-center"><div class="row"><section class="col-md-6"><i class="fa fa-3x fa-github" aria-hidden="true"></i><h4>Get the source code</h4><p>Stay tuned to contribute or build your own solution.</p><p class="link-button"><a href="https://github.com/syndesisio" rel="nofollow" target="_blank" class="btn btn-primary">Syndesis on GitHub</a></p></section><section class="col-md-6"><i class="fa fa-3x fa-comments-o"></i><h4>Connect with us</h4><p>Chat with the Syndesis community.</p><p class="link-button"><a href="irc://freenode.net/syndesis" rel="nofollow" target="_blank" class="btn btn-primary">#syndesis on Freenode IRC</a></p></section></div><div class="rh-logo"><section><a href="https://www.redhat.com" rel="nofollow" title="Red Hat, Inc." target="_blank"><img src="https://syndesis.io/images/redhat.svg" alt="Red Hat, Inc."></a></section></div></footer></div><script src="https://syndesis.io/js/syndesis.js"></script></body></html>