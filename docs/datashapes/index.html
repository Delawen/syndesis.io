<!DOCTYPE html><html lang="en-gb"><head><meta name="generator" content="Hugo 0.20.7"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Syndesis Data Shapes | Syndesis</title><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-98663114-1","auto"),ga("send","pageview")</script><link rel="canonical" href="https://syndesis.io/docs/datashapes/"><link rel="icon" type="image/png" href="https://syndesis.io/images/favicon.png"><meta name="generator" content="Hugo 0.20.7"><link href="https://fonts.googleapis.com/css?family=Raleway:400,500|Righteous" rel="stylesheet"><link rel="stylesheet" href="https://syndesis.io/css/syndesis.css"></head><body class="docs"><div id="wrapper"><a href="https://github.com/syndesisio" class="github-corner hidden-md-down" aria-label="View source on Github" rel="nofollow" target="_blank"><svg width="74" height="74" viewBox="0 0 250 250" style="fill:#fff;z-index:2000;color:#0088ce;mix-blend-mode:screen;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7
        120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9
        125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6
        C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0
        C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1
        C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4
        C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9
        C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5
        C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9
        L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><nav class="navbar fixed-top navbar-inverse bg-primary navbar-toggleable-md sps sps--abv"><button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-nav" aria-controls="top-nav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button> <a href="https://syndesis.io/" title="Syndesis"><svg id="artwork" xmlns="http://www.w3.org/2000/svg" width="190px" height="39.33px" viewBox="0 0 1300 300" preserveAspectRatio="xMidYMin slice"><defs><style>.cls-1{fill:#9adde8}.cls-2{fill:#49badc}.cls-3{fill:#fff}</style></defs><title>Syndesis Logo</title><polygon class="cls-1" points="129.95 98.77 33.99 144.38 122.22 167.37 218.18 121.75 129.95 98.77"/><polygon class="cls-2" points="218.18 121.75 218.18 121.75 122.22 167.37 242.17 198.61 218.18 121.75"/><polygon class="cls-1" points="154.99 86.86 131 10 10 67.52 129.95 98.77 154.99 86.86"/><polygon class="cls-2" points="33.99 144.38 129.95 98.77 10 67.52 10 67.52 33.99 144.38"/><polygon class="cls-2" points="189.64 25.27 131 10 154.99 86.86 213.63 102.14 189.64 25.27"/><polygon class="cls-2" points="38.54 164 62.53 240.86 121.17 256.13 121.17 256.13 97.18 179.27 97.18 179.27 38.54 164"/><polygon class="cls-1" points="242.17 198.61 122.22 167.37 97.18 179.27 121.17 256.13 242.17 198.61"/><path class="cls-3" d="M358.91,210.23c-23.57,0-43.44-17.22-44.06-41.6H329.2c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.65-9.63,35.65-28.48,0-14.76-10.65-21.73-23.15-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.15,35.25H399.28c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C416.29,200.39,388.62,210.23,358.91,210.23Z"/><path class="cls-3" d="M484.32,143.22l-54.51-84h17l45.29,71.52L537.4,59.2h14.34l-54.1,83.61v64.34H484.32Z"/><path class="cls-3" d="M572.24,59.2H587.4L669,189.32h.41V59.2h13.32v148h-16.8L586,79.28h-.41V207.15H572.24Z"/><path class="cls-3" d="M760,59.2c48.56,0,76.23,25,76.23,74s-27.67,74-76.23,74H720V59.2Zm3.27,135.66c41.6,0,58.61-24.39,58.61-61.69,0-43.64-25.61-62.91-67.62-61.68h-20.9V194.86Z"/><path class="cls-3" d="M870.19,207.15V59.2H958.1V71.49H883.51v53.08h71.73v12.29H883.51v58h77.67v12.29Z"/><path class="cls-3" d="M1030.44,210.23c-23.56,0-43.44-17.22-44.05-41.6h14.34c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.66-9.63,35.66-28.48,0-14.76-10.66-21.73-23.16-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.16,35.25h-14.35c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C1087.82,200.39,1060.16,210.23,1030.44,210.23Z"/><path class="cls-3" d="M1121.63,207.15V58.58H1135V207.15Z"/><path class="cls-3" d="M1212.62,210.23c-23.56,0-43.44-17.22-44.06-41.6h14.35c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.66-9.63,35.66-28.48,0-14.76-10.66-21.73-23.16-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.16,35.25H1253c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C1270,200.39,1242.34,210.23,1212.62,210.23Z"/></svg></a><div class="collapse navbar-collapse" id="top-nav"><ul class="navbar-nav ml-auto mt-2 mt-md-0 mr-lg-4"><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/quickstart/">quickstart</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/docs/">docs</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/blog/">blog</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/faq/">faq</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/community/">community</a></li></ul></div></nav><div id="main" class="d-flex flex-row"><div id="sidebar" class="sidenav"><aside><ul class="sidebar-menu"><li class="nav-button hidden-lg-up"><button type="button" class="btn btn-primary btn-sm" data-toggle="offcanvas" data-target="#sidebar">Hide nav</button></li><li><a class="" href="https://syndesis.io/about/"><i class="fa fa-fw fa-download"></i> <span>About Syndesis</span></a></li><li><a class="" href="https://syndesis.io/quickstart/"><i class="fa fa-fw fa-rocket"></i> <span>Quickstart</span></a></li><li class="sub-menu active"><a class="d-flex justify-content-between" href="https://syndesis.io/docs/"><span><i class="fa fa-fw fa-book"></i> Developer Docs</span> <span class="mr-1 expander"></span></a><ul class="sub collapse show"><li><a href="https://syndesis.io/docs/development/">Development</a></li><li><a href="https://syndesis.io/docs/backend_architecture/">Backend architecture</a></li><li><a href="https://syndesis.io/docs/cli/">CLI</a></li><li><a href="https://syndesis.io/docs/connectors/">Connectors development</a></li><li class="active"><a href="https://syndesis.io/docs/datashapes/">Data Shapes</a></li><li><a href="https://syndesis.io/docs/connector-schema/">Connector Schema explained</a></li></ul></li><li><a class="" href="https://syndesis.io/faq/"><i class="fa fa-fw fa-file-text"></i> <span>FAQ</span></a></li><li class="sub-menu"><a class="d-flex justify-content-between" href="https://syndesis.io/community/"><span><i class="fa fa-fw fa-group"></i> Community</span> <span class="mr-1 expander"></span></a><ul class="sub collapse"><li><a href="https://syndesis.io/community/contributing/">Contributing</a></li><li><a href="https://syndesis.io/community/engineering_guidelines/">Engineering Guidelines</a></li></ul></li><li><a href="https://github.com/syndesisio/syndesis/issues/" target="blank"><i class="fa fa-life-ring"></i> <span>Issues & Help</span></a></li><li><a href="https://github.com/syndesisio/syndesis.io/edit/master/content/docs/datashapes.md" target="blank"><i class="fa fa-fw fa-edit"></i> Refine this Page</a></li></ul></aside></div><div class="main-content"><div itemscope class="doc"><meta itemprop="name" content="Syndesis Data Shapes"><meta itemprop="description" content="A very important feature of any integration platform is to manage transparently the data format between the source and the destination channel. Syndesis and the powerful visual data mapper tool bundled with it, simplifies this concept with the definition of a datashape.
A datashape is a way to describe any inbound/outbound message format and to allow the user to easily map each data property in the integration step: said in other words, you will be able to transform on the fly the input/output of the data involved in an integration."><meta itemprop="wordCount" content="1227"><meta itemprop="keywords" content=""><div class="hero"><h1 itemprop="headline">Syndesis Data Shapes</h1></div><div itemprop="docBody" class="docBody"><p>A very important feature of any integration platform is to manage transparently the data format between the source and the destination channel. Syndesis and the powerful visual data mapper tool bundled with it, simplifies this concept with the definition of a <code>datashape</code>.</p><p>A <code>datashape</code> is a way to describe any inbound/outbound message format and to allow the user to easily map each data property in the integration step: said in other words, you will be able to transform on the fly the input/output of the data involved in an integration.</p><h3 id="json-descriptor">JSON Descriptor</h3><p>When you <a href="../connectors/">develop a new Syndesis connector</a> you must specify a file descriptor that defines several properties of the source/destination involved. The section related to the data shapes is defined by the <code>descriptor.inputDataShape</code> and <code>descriptor.outputDataShape</code>. The format is the same, but, as the name let it guess, you will be able to specify a different format if the data you&rsquo;re describing is the input or the output of the connector involved.</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">{</span>
<span style="color:#a61717;background-color:#e3d2d2">  &quot;actions&quot;: [</span>
<span style="color:#a61717;background-color:#e3d2d2">    {</span>
<span style="color:#a61717;background-color:#e3d2d2">      &quot;actionType&quot;:</span>
<span style="color:#a61717;background-color:#e3d2d2">        ...</span>
<span style="color:#a61717;background-color:#e3d2d2">      &quot;descriptor&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">        ...</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;inputDataShape&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;kind&quot;:</span>
<span style="color:#a61717;background-color:#e3d2d2">            ...</span>
<span style="color:#a61717;background-color:#e3d2d2">        },</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;outputDataShape&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;kind&quot;:</span>
<span style="color:#a61717;background-color:#e3d2d2">            ...</span>
<span style="color:#a61717;background-color:#e3d2d2">        },</span>
</pre></div><p>First of all, let&rsquo;s explore a complete description of a datashape (we use as an example an <code>inputDataShape</code> but the same is valid for the output):</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">        &quot;inputDataShape&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;name&quot;: &quot;my data shape&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;description&quot;: &quot;my data shape description&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;kind&quot;: &quot;java&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;type&quot;: &quot;io.syndesis.connector.mycomponent.MyModel&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;specification&quot;: &quot;used in json-schema only&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;collectionClass&quot;: &quot;java.util.ArrayList&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;collectionType&quot;: &quot;List&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;metadata&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">            &quot;variant&quot;: &quot;collection&quot;</span>
<span style="color:#a61717;background-color:#e3d2d2">          },</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;variants&quot;: [</span>
<span style="color:#a61717;background-color:#e3d2d2">            {</span>
<span style="color:#a61717;background-color:#e3d2d2">              &quot;kind&quot;: &quot;java&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">              &quot;metadata&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">                &quot;compression&quot;: &quot;true&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">                &quot;variant&quot;: &quot;element&quot;</span>
<span style="color:#a61717;background-color:#e3d2d2">              },</span>
<span style="color:#a61717;background-color:#e3d2d2">              &quot;type&quot;: &quot;io.syndesis.connector.mycomponent.MyModelSplit&quot;</span>
<span style="color:#a61717;background-color:#e3d2d2">            }</span>
<span style="color:#a61717;background-color:#e3d2d2">          ]</span>
<span style="color:#a61717;background-color:#e3d2d2">        },</span>
</pre></div><p>Don&rsquo;t worry, the above is the full definition, in majority of the cases you won&rsquo;t need to define all those configuration. Let&rsquo;s explain briefly what everything stands for.</p><p>The <code>kind</code> parameter is the most important as it is used by Syndesis to convert any input/output message to the specified <code>kind</code>. This is the only required field when declaring a datashape, so, most of the times, you will finally end up just setting this and the <code>specification</code> field when configuring your connector. We allow the following values:</p><ul><li><strong>any</strong>: open specification - read next paragraph for more info</li><li><strong>java</strong>: used in conjunction of <code>type</code> to define the java class to convert the data to</li><li><strong>json-schema</strong>: used in conjunction to <code>specification</code> to define the json schema expected</li><li><strong>json-instance</strong>: used to represent a generic json instance</li><li><strong>xml-schema</strong>: used in conjunction to <code>specification</code> to define the xml schema expected</li><li><strong>xml-schema-inspected</strong>: used in conjunction to <code>specification</code> to define the xml schema expected inspecting any included resource type</li><li><strong>xml-instance</strong>: used to represent a generic xml instance</li><li><strong>none</strong>: used if no data is expected</li></ul><p>The <code>type</code> is used only when the <code>kind</code> specified and will have to contain the full package and class name of the expected java type. The collections configuration are used when you&rsquo;re expecting a java collection of elements, you can specify the interface and the concrete implementation to use.</p><p><code>metadata</code> and <code>variants</code> are used to specify certain configuration that could help the split and aggregate EIP features. By defining the <code>metadata</code> as either an <code>element</code> or <code>collection</code> you will declare explicitly if the expected data is a single element or an array of elements, sparing the &ldquo;guesswork&rdquo; at runtime. Also, using <code>variants</code> declaration, the splitting feature will be able to work correctly by knowing how to split the original message (ie, through another <code>java</code> class model).</p><h5 id="any-and-none-datashapes">ANY and NONE datashapes</h5><p>We reserve a particular mention to the <code>any</code> datashape as this kind can be quite useful when you don&rsquo;t know beforehand the expected data model. When you define it, Syndesis will provide you an additional user interface requiring to fill with the expected datashape. This is particularly useful as you will leave the user to select the data model expect at runtime.</p><p>Also <code>none</code> is useful if you don&rsquo;t expect any data at all (tipically in the source connectors input data shapes).</p><h5 id="static-vs-dynamic-datashape">Static vs Dynamic datashape</h5><p>The above example is showing a &ldquo;static&rdquo; configuration of a datashape that will be always the same once it has been deployed to your platform. Most of the time this is not useful, as your data shape vary depending on the parameters configuration submitted by the final user. <code>dymanic</code> tag comes to rescue!</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">{</span>
<span style="color:#a61717;background-color:#e3d2d2">  &quot;actions&quot;: [</span>
<span style="color:#a61717;background-color:#e3d2d2">    {</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;inputDataShape&quot;: {...},</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;outputDataShape&quot;: {...},</span>
<span style="color:#a61717;background-color:#e3d2d2">      },</span>
<span style="color:#a61717;background-color:#e3d2d2">      ...</span>
<span style="color:#a61717;background-color:#e3d2d2">      &quot;pattern&quot;: &quot;To&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">      &quot;tags&quot;: [</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;dynamic&quot;</span>
<span style="color:#a61717;background-color:#e3d2d2">      ]</span>
</pre></div><p>When this is set, you&rsquo;re instructing Syndesis gui to look up for the <code>meta</code> information to be retrieved dynamically and according the parameters that the user is submitting in each step of the integration configuration, including the <code>datashape</code>s. The GUI is triggering a call to the <code>server</code> that will forward the request to the <code>meta</code> which is finally the one that knows how to retrieve such information (see <a href="../backend_architecture/">backend architecture diagram</a>).</p><p>Let&rsquo;s then discover how to develop such extension and how to recover dynamically <code>metadata</code> in Syndesis.</p><h3 id="development-example">Development example</h3><p>In order to simplify the discussion, let&rsquo;s follow up with the same example provided in the <a href="../connectors/">connector development guideline</a>.</p><p>We expect our integration to be able to handle any input coming from any source with the format expected by the collection provided by the user. So we&rsquo;ll define dynamically a <code>json-schema</code> that will read the specification directly from the database (at runtime). The output expected is a generic <code>json-instance</code>, as there are several operations that our producer can perform.</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">{</span>
<span style="color:#a61717;background-color:#e3d2d2">  &quot;version&quot;: 4,</span>
<span style="color:#a61717;background-color:#e3d2d2">  &quot;actions&quot;: [</span>
<span style="color:#a61717;background-color:#e3d2d2">    {</span>
<span style="color:#a61717;background-color:#e3d2d2">      &quot;actionType&quot;: &quot;connector&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">      &quot;descriptor&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;componentScheme&quot;: &quot;mongodb3&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">        ...</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;inputDataShape&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;kind&quot;: &quot;json-schema&quot;</span>
<span style="color:#a61717;background-color:#e3d2d2">        },</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;outputDataShape&quot;: {</span>
<span style="color:#a61717;background-color:#e3d2d2">          &quot;kind&quot;: &quot;json-instance&quot;</span>
<span style="color:#a61717;background-color:#e3d2d2">        },</span>
<span style="color:#a61717;background-color:#e3d2d2">      ...</span>
<span style="color:#a61717;background-color:#e3d2d2">      &quot;pattern&quot;: &quot;To&quot;,</span>
<span style="color:#a61717;background-color:#e3d2d2">      &quot;tags&quot;: [</span>
<span style="color:#a61717;background-color:#e3d2d2">        &quot;dynamic&quot;</span>
<span style="color:#a61717;background-color:#e3d2d2">      ]</span>
</pre></div><p>As we&rsquo;ve marked the connector as dynamic we will have to instruct the platform how to properly retrieve the meta-information. We need to create a simple file beside the main json descriptor under</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">META-INF/syndesis/connector/meta/mongodb3</span>
</pre></div><p>This will contain a simple configuration pointing at the right java class:</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#a61717;background-color:#e3d2d2">class=io.syndesis.connector.mongo.meta.MongoDBMetadataRetrieval</span>
</pre></div><p>The class has to extend <code>io.syndesis.connector.support.verifier.api.ComponentMetadataRetrieval</code> with only a method, whose goal is to either retrieve the meta information you need, or, adapt the ones that may be already provided by the upstream component that you&rsquo;re extending from Camel. You should possibly adopt this last strategy deferring to the platform (Camel in our case) the duty to retrieve such meta information.</p><div class="highlight" style="background:#fff"><pre style="line-height:125%"><span></span><span style="color:#000;font-weight:700">public</span><span style="color:#bbb"> </span>final<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">class</span><span style="color:#bbb"> </span>MongoDBMetadataRetrieval<span style="color:#bbb"> </span>extends<span style="color:#bbb"> </span>ComponentMetadataRetrieval<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">{</span><span style="color:#bbb"></span>
<span style="color:#bbb">    </span><span style="color:teal">@Override</span><span style="color:#bbb"></span>
<span style="color:#bbb">    </span>protected<span style="color:#bbb"> </span>SyndesisMetadata<span style="color:#bbb"> </span>adapt(CamelContext<span style="color:#bbb"> </span>context,<span style="color:#bbb"> </span>String<span style="color:#bbb"> </span>componentId,<span style="color:#bbb"> </span>String<span style="color:#bbb"> </span>actionId,<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">Map&lt;</span>String,<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">Object&gt;</span><span style="color:#bbb"> </span>properties,<span style="color:#bbb"> </span>MetaDataExtension.MetaData<span style="color:#bbb"> </span>metadata)<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">{</span><span style="color:#bbb"></span>
<span style="color:#bbb">        </span>String<span style="color:#bbb"> </span>jsonPayload<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">=</span><span style="color:#bbb"> </span>metadata.getPayload(String.<span style="color:#000;font-weight:700">class</span>);<span style="color:#bbb"></span>
<span style="color:#bbb">        </span>LOGGER.debug(<span style="color:#990073">&quot;Adapting meta retrieved by upstream component {}&quot;</span>,<span style="color:#bbb"> </span>jsonPayload);<span style="color:#bbb"></span>
<span style="color:#bbb">        </span>DataShape<span style="color:#bbb"> </span>jsonSchemaDataShape<span style="color:#bbb"> </span><span style="color:#000;font-weight:700">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:700">new</span><span style="color:#bbb"> </span>DataShape.Builder()<span style="color:#bbb"></span>
<span style="color:#bbb">            </span>.name(String.<span style="color:#900;font-weight:700">format</span>(<span style="color:#990073">&quot;%s.%s&quot;</span>,<span style="color:#bbb"> </span>properties.<span style="color:#000;font-weight:700">get</span>(<span style="color:#990073">&quot;database&quot;</span>),<span style="color:#bbb"> </span>properties.<span style="color:#000;font-weight:700">get</span>(<span style="color:#990073">&quot;collection&quot;</span>)))<span style="color:#bbb"></span>
<span style="color:#bbb">            </span>.description(String.<span style="color:#900;font-weight:700">format</span>(<span style="color:#990073">&quot;Schema validator for %s collection&quot;</span>,<span style="color:#bbb"> </span>properties.<span style="color:#000;font-weight:700">get</span>(<span style="color:#990073">&quot;collection&quot;</span>)))<span style="color:#bbb"></span>
<span style="color:#bbb">            </span>.kind(DataShapeKinds.JSON_SCHEMA)<span style="color:#bbb"></span>
<span style="color:#bbb">            </span>.specification(jsonPayload)<span style="color:#bbb"></span>
<span style="color:#bbb">            </span>.build();<span style="color:#bbb"></span>

<span style="color:#bbb">        </span><span style="color:#000;font-weight:700">return</span><span style="color:#bbb"> </span>SyndesisMetadata.<span style="color:#000;font-weight:700">of</span>(jsonSchemaDataShape);<span style="color:#bbb"></span>
<span style="color:#bbb">    </span><span style="color:#a61717;background-color:#e3d2d2">}</span><span style="color:#bbb"></span>
<span style="color:#a61717;background-color:#e3d2d2">}</span><span style="color:#bbb"></span>
</pre></div><p>The example above should ease the discussion. Our goal in Syndesis is to <em>adapt</em> the meta information coming from the upstream platform: in our case, the payload retrieved in the <code>metadata</code> parameter is a json-schema payload that the <code>camel-mongodb</code> component is getting on our behalf - it uses the information in the properties to query the database and collection and return the expected <a href="https://docs.mongodb.com/manual/core/schema-validation/#json-schema">json-schema validator</a>. Of course, this business logic may be different in each component, but the principle is the same: getting the meta information on the source/destination, parse it here and adapt according to Syndesis data model.</p><p>As we&rsquo;de delegated the complex stuff to the platform, the rest is to simply adapt the format. You can see that we&rsquo;re setting a nice <code>name</code> and <code>description</code>, the <code>kind</code> as json-schema and the retrieved <code>specification</code>. Finally we&rsquo;re calling the <code>SyndesisMetadata.of(...)</code> that will set the datashape both for input and output. Cool, with this example you will be able now to <em>adapt</em> dynamically the datashape for any kind of connector, as you likely will have a different data structure for each of them.</p></div></div></div><div class="toc hidden-md-down"><nav id="TableOfContents"><ul><li><ul><li><ul><li><a href="#json-descriptor">JSON Descriptor</a><ul><li><ul><li><a href="#any-and-none-datashapes">ANY and NONE datashapes</a></li><li><a href="#static-vs-dynamic-datashape">Static vs Dynamic datashape</a></li></ul></li></ul></li><li><a href="#development-example">Development example</a></li></ul></li></ul></li></ul></nav></div></div><footer class="page-footer text-center"><div class="row"><section class="col-md-6"><i class="fa fa-3x fa-github" aria-hidden="true"></i><h4>Get the source code</h4><p>Stay tuned to contribute or build your own solution.</p><p class="link-button"><a href="https://github.com/syndesisio" rel="nofollow" target="_blank" class="btn btn-primary">Syndesis on GitHub</a></p></section><section class="col-md-6"><i class="fa fa-3x fa-comments-o"></i><h4>Connect with us</h4><p>Chat with the Syndesis community.</p><p class="link-button"><a href="irc://freenode.net/syndesis" rel="nofollow" target="_blank" class="btn btn-primary">#syndesis on Freenode IRC</a></p></section></div><div class="rh-logo"><section><a href="https://www.redhat.com" rel="nofollow" title="Red Hat, Inc." target="_blank"><img src="https://syndesis.io/images/redhat.svg" alt="Red Hat, Inc."></a></section></div></footer></div><script src="https://syndesis.io/js/syndesis.js"></script></body></html>