<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">

<head>
  {{ hugo.Generator }}
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>{{ block "title" . }}{{ .Title }}{{ end }}</title>
  {{ with .Description }}
  <meta name="description" content="{{ . }}"> {{ end }}

  <!-- Site verification -->
  {{ if .IsHome }} {{ partial "site-verification" . }} {{ end }}
  <!-- add googleAnalytics in config.toml -->
  {{ template "_internal/google_analytics.html" . }}
  {{ if .RSSLink }}<link href="{{ .RSSLink }}" rel="alternate" type="application/rss+xml" title="{{ .Site.Title }}" />{{ end }}
  <link rel="canonical" href="{{ .Permalink }}"> {{ if (isset .Params "prev") }}
  <link rel="prev" href="{{ .Params.prev }}"> {{ end }} {{ if (isset .Params "next") }}
  <link rel="next" href="{{ .Params.next }}"> {{ end }}

  {{ partial "favicon" . }}

  <!-- Bootstrap CSS -->{{ .Hugo.Generator }}
  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/syndesis.css">
</head>

<body class="{{ .Type }}{{ if .IsHome }} home{{ end }}">
  <div id="wrapper">
    {{ partial "github-corner.html" .}}
    {{ partial "topnav" . }}

    <div id="main"{{ if not .IsHome }} class="d-flex flex-row"{{ end}}>
      {{ if not .IsHome }}
      <div id="sidebar" class="sidenav{{ if not (isset .Params "sidebar") }} no-sidebar{{ end }}">

      {{ if $.Param "sidebar" }}{{ partial "sidenav" . }}{{ end }}

      <!-- START TESTING ZONE --
      {{ if $.Param "test" }}
      <nav id="single-menu" class="l" data-dir="{{ $.Param "languagedir" | default "ltr" }}">
      {{ if $.Param "enableMenu" }}
      {{ end }}
      </nav>
      {{ end }}
      -->
      <!-- END TESTING ZONE -->
    </div>
    {{ end }}
      <div class="main-content">
        {{ block "main" . }}{{ end }}
      </div>
      {{ if .Params.toc }}
        <div class="toc hidden-md-down">
          {{ .TableOfContents }}
        </div>
      {{ else }}
        <div class="no-toc hidden-md-down"></div>
      {{ end}}
    </div>

    {{ partial "footer" . }}
  </div>

  <script src="/js/syndesis.js"></script>

  <script>
    "use strict";

    {{ $languagedir := ($.Param "languagedir" | default "ltr") }}
    var languagedir = JSON.parse({{ $languagedir | jsonify }});

    window.onload = function() {
      // ===================== Navbar Collapse ======================
      var navCollapseBtn = document.getElementById('navCollapseBtn');
      navCollapseBtn ? navCollapseBtn.addEventListener('click', function(e) {
        var navCollapse = document.querySelector('.navbar__collapse');

        if (navCollapse) {
          var dataOpen = navCollapse.getAttribute('data-open');

          if (dataOpen === 'true') {
            navCollapse.setAttribute('data-open', 'false');
            navCollapse.style.maxHeight = 0;
          } else {
            navCollapse.setAttribute('data-open', 'true');
            navCollapse.style.maxHeight = navCollapse.scrollHeight + 'px';
          }
        }
      }) : null;

      // ========================== Expand ==========================
      var expandBtn = document.querySelectorAll('.expand__button');

      for (var i = 0; i < expandBtn.length; i++) {
        expandBtn[i].addEventListener('click', function () {
          var content = this.nextElementSibling;
          if (content.style.maxHeight) {
            content.style.maxHeight = null;
            this.querySelector('svg').classList.add('expand-icon__right');
            this.querySelector('svg').classList.remove('expand-icon__down');
          } else {
            content.style.maxHeight = content.scrollHeight + 'px';
            this.querySelector('svg').classList.remove('expand-icon__right');
            this.querySelector('svg').classList.add('expand-icon__down');
          }
        });
      }

      // =================== Section Menu Collapse ==================
      document.querySelectorAll('.menu__list').forEach(function(elem) {
        if (elem.classList.contains('active')) {
          elem.style.maxHeight = elem.scrollHeight + 'px';
        }
      });

      document.querySelectorAll('.menu__title--collapse').forEach(function(elem) {
        elem.addEventListener('click', function (e) {
          var content = this.nextElementSibling;
          var menuTitleIcon = this.querySelector('.menu__title--icon');
          if (!content) {
            return null;
          }

          var parent = elem.parentNode;
          while (parent.classList.contains('menu__list') && parent.classList.contains('active')) {
            parent.style.maxHeight = 100 * parent.children.length + 'px';
            parent = parent.parentNode;
          }

          if (content.style.maxHeight) {
            content.style.maxHeight = null;
            content.classList.remove('active');
            menuTitleIcon.classList.add('right');
            menuTitleIcon.classList.remove('down');
          } else {
            content.style.maxHeight = content.scrollHeight + 'px';
            content.classList.add('active');
            menuTitleIcon.classList.remove('right');
            menuTitleIcon.classList.add('down');
          }
        });
      });
    };
  </script>

  {{ block "pagejs" . }}{{ end }}
</body>
</html>
